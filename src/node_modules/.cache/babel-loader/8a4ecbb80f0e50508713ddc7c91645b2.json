{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { asyncScheduler } from '../scheduler/async';\nimport { isValidDate } from '../util/isDate';\nimport { operate } from '../util/lift';\nimport { innerFrom } from '../observable/innerFrom';\nimport { createErrorClass } from '../util/createErrorClass';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nimport { executeSchedule } from '../util/executeSchedule';\nexport var TimeoutError = createErrorClass(function (_super) {\n  return function TimeoutErrorImpl(info) {\n    if (info === void 0) {\n      info = null;\n    }\n\n    _super(this);\n\n    this.message = 'Timeout has occurred';\n    this.name = 'TimeoutError';\n    this.info = info;\n  };\n});\nexport function timeout(config, schedulerArg) {\n  var _a = isValidDate(config) ? {\n    first: config\n  } : typeof config === 'number' ? {\n    each: config\n  } : config,\n      first = _a.first,\n      each = _a.each,\n      _b = _a.with,\n      _with = _b === void 0 ? timeoutErrorFactory : _b,\n      _c = _a.scheduler,\n      scheduler = _c === void 0 ? schedulerArg !== null && schedulerArg !== void 0 ? schedulerArg : asyncScheduler : _c,\n      _d = _a.meta,\n      meta = _d === void 0 ? null : _d;\n\n  if (first == null && each == null) {\n    throw new TypeError('No timeout provided.');\n  }\n\n  return operate(function (source, subscriber) {\n    var originalSourceSubscription;\n    var timerSubscription;\n    var lastValue = null;\n    var seen = 0;\n\n    var startTimer = function (delay) {\n      timerSubscription = executeSchedule(subscriber, scheduler, function () {\n        try {\n          originalSourceSubscription.unsubscribe();\n          innerFrom(_with({\n            meta: meta,\n            lastValue: lastValue,\n            seen: seen\n          })).subscribe(subscriber);\n        } catch (err) {\n          subscriber.error(err);\n        }\n      }, delay);\n    };\n\n    originalSourceSubscription = source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n      timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n      seen++;\n      subscriber.next(lastValue = value);\n      each > 0 && startTimer(each);\n    }, undefined, undefined, function () {\n      if (!(timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.closed)) {\n        timerSubscription === null || timerSubscription === void 0 ? void 0 : timerSubscription.unsubscribe();\n      }\n\n      lastValue = null;\n    }));\n    !seen && startTimer(first != null ? typeof first === 'number' ? first : +first - scheduler.now() : each);\n  });\n}\n\nfunction timeoutErrorFactory(info) {\n  throw new TimeoutError(info);\n}","map":{"version":3,"mappings":"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","names":["asyncScheduler","isValidDate","operate","innerFrom","createErrorClass","createOperatorSubscriber","executeSchedule","TimeoutError","_super","TimeoutErrorImpl","info","message","name","timeout","config","schedulerArg","first","each","_b","_with","timeoutErrorFactory","_c","scheduler","_d","meta","TypeError","source","subscriber","originalSourceSubscription","timerSubscription","lastValue","seen","startTimer","delay","unsubscribe","subscribe","err","error","value","next","undefined","closed","now"],"sourceRoot":"","sources":["../../../../src/internal/operators/timeout.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}