{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { reactive, ref, onMounted, computed } from \"vue\";\nimport axios from \"axios\";\nimport { useStore } from 'vuex';\nexport default {\n  __name: 'DashBoard',\n\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const store = useStore();\n    const state = reactive({\n      tasks: [],\n      comments: [],\n      likes: []\n    });\n    const tasks = ref([]);\n    const comments = ref([]);\n    const likes = ref([]);\n    const countLikes = ref([]);\n    const inputTask = ref('');\n    const isEdit = ref([]);\n    const isEditting = ref(false);\n    const commentsOfOneTask = ref(null);\n    const likeStatus = ref('text-gray-400');\n    const createTaskBtnRef = ref(null); // const addCmtBtnRef = ref(null);\n    // const addCmtInputRef = ref(null);\n\n    const username = computed(() => store.state.username); // Tasks\n\n    const createTask = async () => {\n      createTaskBtnRef.value.disabled = true;\n      createTaskBtnRef.value.innerText = 'Loading...';\n      const data = {\n        content: inputTask.value\n      };\n      const response = await axios.post('http://localhost:3000/tasks', data, {\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json;charset=UTF-8\"\n        },\n        withCredentials: true\n      });\n      inputTask.value = '';\n      tasks.value.push(response.data);\n      const responseDataId = response.data.id;\n      comments.value[responseDataId] = [];\n      likes.value[responseDataId] = '';\n      isEdit.value[responseDataId] = false;\n      console.log(comments.value);\n      console.log(likes.value); // getTasks();\n\n      createTaskBtnRef.value.disabled = false;\n      createTaskBtnRef.value.innerText = 'Create Task';\n    };\n\n    const getTasks = async () => {\n      const response = await axios.get('http://localhost:3000/tasks', {\n        withCredentials: true\n      });\n      tasks.value = response.data; // state.tasks = response.data;\n    };\n\n    const deleteTask = async taskId => {\n      await axios.delete(`http://localhost:3000/tasks/${taskId}`, {\n        withCredentials: true\n      });\n      tasks.value = tasks.value.filter(item => item.id !== taskId);\n      console.log(tasks.value);\n    };\n\n    const editTask = async taskId => {\n      isEditting.value = true;\n      const editInputElement = document.getElementById(`editInput${taskId}`);\n      const data = {\n        content: editInputElement.value\n      };\n      await axios.patch(`http://localhost:3000/tasks/${taskId}`, data, {\n        withCredentials: true\n      });\n      const task = tasks.value.find(element => element.id === taskId);\n      task.content = editInputElement.value;\n      isEditting.value = false;\n      isEdit.value[taskId] = false;\n      editInputElement.value = '';\n    }; // Comments\n\n\n    const addComment = async taskId => {\n      const inputCommentElement = document.getElementById(`inputComment${taskId}`);\n      const buttonCommentElement = document.getElementById(`buttonComment${taskId}`);\n      console.log(inputCommentElement.value);\n      buttonCommentElement.disabled = true;\n      buttonCommentElement.classList.toggle('hover:bg-slate-100');\n      buttonCommentElement.innerText = 'Loading...';\n      const data = {\n        content: inputCommentElement.value\n      };\n      const response = await axios.post(`http://localhost:3000/tasks/${taskId}/comments`, data, {\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json;charset=UTF-8\"\n        },\n        withCredentials: true\n      });\n      inputCommentElement.value = '';\n      buttonCommentElement.disabled = false;\n      buttonCommentElement.innerText = 'Add comment';\n      buttonCommentElement.classList.toggle('hover:bg-slate-100');\n      comments.value[taskId].push(response.data);\n    };\n\n    const deleteComment = async (commentId, taskId) => {\n      comments.value[taskId] = comments.value[taskId].filter(item => item.id !== commentId);\n      await axios.delete(`http://localhost:3000/tasks/comments/${commentId}`, {\n        withCredentials: true\n      }); // arr = arr.filter(item => item !== value)\n\n      console.log(comments.value[taskId]);\n    };\n\n    const getCmtsFromOneTask = async taskId => {\n      const response = await axios.get(`http://localhost:3000/tasks/${taskId}/comments`, {\n        withCredentials: true\n      });\n      commentsOfOneTask.value = response.data;\n    }; // Likes\n\n\n    const likeClick = async taskId => {\n      if (likes.value[taskId].status === false || likes.value[taskId] === '') {\n        if (likes.value[taskId] === '') {\n          likes.value[taskId] = {};\n        }\n\n        likes.value[taskId].status = true;\n        countLikes.value[taskId] += 1;\n        const data = {\n          status: true\n        };\n        await axios.post(`http://localhost:3000/tasks/${taskId}/likes`, data, {\n          headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json;charset=UTF-8\"\n          },\n          withCredentials: true\n        });\n      } else if (likes.value[taskId].status === true) {\n        // const data = {status: false};\n        // const index = likes.value.indexOf(taskId);\n        // likes.value[taskId].status = false;\n        // likes.value.splice(index, 1);\n        likes.value[taskId] = '';\n        countLikes.value[taskId] -= 1;\n        await axios.delete(`http://localhost:3000/tasks/${taskId}/likes`, {\n          headers: {\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json;charset=UTF-8\"\n          },\n          withCredentials: true\n        });\n      }\n    };\n\n    onMounted(async () => {\n      const response = await axios.get('http://localhost:3000/tasks', {\n        withCredentials: true\n      });\n      console.log(response.data);\n      tasks.value = response.data;\n      let count = 0;\n      tasks.value.forEach(async ele => {\n        // const commentsLink = `http://localhost:3000/tasks/${ele.id}/comments`;\n        // const likesLink = `http://localhost:3000/tasks/${ele.id}/likes`;\n        // const requestComments = axios.get(commentsLink, {withCredentials: true});\n        // const requestLikes = axios.get(likesLink, {withCredentials: true});\n        // await axios.all([requestComments, requestLikes]).then(\n        //     axios.spread((...responses) => {\n        //     comments.value[ele.id] = responses[0];\n        //     likes.value[ele.id] = responses[1];\n        //     })\n        // );\n        let response;\n        response = await axios.get(`http://localhost:3000/tasks/${ele.id}/comments`, {\n          withCredentials: true\n        });\n        comments.value[ele.id] = response.data;\n        response = await axios.get(`http://localhost:3000/tasks/${ele.id}/likes`, {\n          withCredentials: true\n        });\n        likes.value[ele.id] = response.data;\n        isEdit.value[ele.id] = false;\n        response = await axios.get(`http://localhost:3000/tasks/${ele.id}/countLikesOfTask`, {\n          withCredentials: true\n        });\n        countLikes.value[ele.id] = response.data;\n      });\n      console.log(tasks.value);\n      console.log(comments.value);\n      console.log(likes.value);\n      console.log(isEdit.value);\n      console.log(countLikes.value);\n    });\n    const __returned__ = {\n      store,\n      state,\n      tasks,\n      comments,\n      likes,\n      countLikes,\n      inputTask,\n      isEdit,\n      isEditting,\n      commentsOfOneTask,\n      likeStatus,\n      createTaskBtnRef,\n      username,\n      createTask,\n      getTasks,\n      deleteTask,\n      editTask,\n      addComment,\n      deleteComment,\n      getCmtsFromOneTask,\n      likeClick,\n      reactive,\n      ref,\n      onMounted,\n      computed,\n      axios,\n      useStore\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"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","names":["reactive","ref","onMounted","computed","axios","useStore","store","state","tasks","comments","likes","countLikes","inputTask","isEdit","isEditting","commentsOfOneTask","likeStatus","createTaskBtnRef","username","createTask","value","disabled","innerText","data","content","response","post","headers","Accept","withCredentials","push","responseDataId","id","console","log","getTasks","get","deleteTask","taskId","delete","filter","item","editTask","editInputElement","document","getElementById","patch","task","find","element","addComment","inputCommentElement","buttonCommentElement","classList","toggle","deleteComment","commentId","getCmtsFromOneTask","likeClick","status","count","forEach","ele"],"sources":["E:/LapTrinh/NestJS/social-media-clone/frontend/src/components/DashBoard.vue"],"sourcesContent":["<template>\r\n    <section class=\" bg-gray-50 h-screen\">\r\n\r\n        <h3>\r\n            Loggin as {{ username }}\r\n        </h3>\r\n\r\n        <div class=\"\">\r\n            <textarea v-model=\"inputTask\" class=\"border border-gray-200\" placeholder=\"create task\"></textarea>\r\n            <button @click=\"createTask()\" ref=\"createTaskBtnRef\" class=\"border border-black bg-slate-200\">Create Task</button>\r\n        </div>\r\n\r\n        <div class=\" relative mx-auto w-3/4 flex justify-around my-3 \">\r\n            <ul class=\" space-y-10 w-2/4\">\r\n                <li v-for=\"task in tasks\" :key=\"task\" class=\" border border-gray-400 rounded-md bg-white\">\r\n                    <div class=\"\">\r\n                        <div class=\"flex\" v-if=\"isEdit[task.id] === true\">\r\n                            <input type=\"text\" :id=\"'editInput' + task.id\" placeholder=\"edit task content\" class=\" flex-1 pl-1\">\r\n                            <div class=\"\" v-if=\"isEditting === false\">\r\n                                <button @click=\"editTask(task.id)\" class=\" bg-green-500 text-white hover:bg-green-400 px-2\">Save</button>\r\n                                <button @click=\"isEdit[task.id] = false\" class=\" bg-slate-200 text-gray-500 hover:bg-slate-300 px-2\">Cancel</button>\r\n                            </div>\r\n                            <div class=\"\" v-else>Loading...</div>\r\n                        </div>\r\n                        <div v-else class=\" px-2 flex justify-between items-center\">\r\n                            <p class=\" font-semibold\">{{ task.content }}</p>\r\n                            <i class=\"fa-solid fa-ellipsis pl-3 mr-3 inline-block hover:cursor-pointer group relative\">\r\n                                <div class=\" absolute -right-6 top-4 w-20 border border-gray-200 bg-white hidden group-hover:inline-block\">\r\n                                    <div class=\" text-xs text-blue-400 hover:bg-sky-200 hover:cursor-pointer pl-1 py-1\" @click=\"isEdit[task.id] = true\">Edit</div>\r\n                                    <div class=\" text-xs text-red-500 hover:bg-red-200 hover:cursor-pointer pl-1 py-1\" @click=\"deleteTask(task.id)\">Delete</div>\r\n                                </div>\r\n                            </i>\r\n                        </div>\r\n                    </div>\r\n                    <hr>\r\n                    <ul class=\" overflow-auto \">\r\n                        <li v-for=\"comment in comments[task.id]\" :key=\"comment\" class=\"flex justify-between items-center px-1 pt-1 group hover:bg-gray-50\">\r\n                            <p class=\"text-sm\">{{comment.content}}</p>\r\n                            <i @click=\"deleteComment(comment.id, task.id)\" class=\"fa-solid fa-x mr-4 text-xs hidden opacity-50 \r\n                                hover:cursor-pointer hover:opacity-80 hover:text-red-500 group-hover:inline-block\"></i>\r\n                        </li>\r\n                    </ul>\r\n                    <div class=\"relative\">\r\n                        <button :class=\"[likes[task.id] === '' ?  'text-gray-400' : 'text-blue-400 bg-sky-100'  ]\" \r\n                                @click=\"likeClick(task.id)\" \r\n                                class=\" px-2 text-sm block border border-gray-200 hover:bg-slate-200 hover:cursor-pointer\">\r\n                                <i class=\"fa-sharp fa-solid fa-thumbs-up mr-2\"></i>Like\r\n                        </button>\r\n                        <span class=\" flex justify-center items-center text-white bg-blue-500\r\n                                     h-4 w-4 text-[13px] rounded-full absolute left-14 -top-1\">{{ countLikes[task.id] }}</span>\r\n                    </div>\r\n                    <div class=\" flex\">\r\n                        <input type=\"text\" :id=\"'inputComment' + task.id\" class=\" flex-1 pl-1 border border-gray-200\" placeholder=\"add comment\">\r\n                        <button @click=\"addComment(task.id)\" :id=\"'buttonComment' + task.id\" \r\n                                class=\" px-2 border border-gray-200 bg-indigo-500 hover:bg-indigo-400 text-gray-100\">Comment</button>\r\n                    </div>\r\n                </li>\r\n            </ul>\r\n\r\n            <div class=\" bg-white border border-gray-400 w-1/4 h-96\">\r\n                <p>Suggest Friend</p>\r\n                <ul></ul>\r\n            </div>\r\n        </div>\r\n    </section>\r\n\r\n\r\n    \r\n\r\n\r\n    \r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, ref, onMounted, computed  } from \"vue\";\r\nimport axios from \"axios\";\r\nimport { useStore } from 'vuex';\r\n\r\nconst store = useStore()\r\n\r\nconst state = reactive({tasks: [], comments: [], likes: []});\r\nconst tasks = ref([]);\r\nconst comments = ref([]);\r\nconst likes = ref([]);\r\nconst countLikes = ref([]);\r\nconst inputTask = ref('');\r\nconst isEdit = ref([]);\r\nconst isEditting = ref(false);\r\n\r\nconst commentsOfOneTask = ref(null);\r\nconst likeStatus = ref('text-gray-400')\r\n\r\nconst createTaskBtnRef = ref(null);\r\n// const addCmtBtnRef = ref(null);\r\n// const addCmtInputRef = ref(null);\r\n\r\n\r\nconst username = computed(() => store.state.username);\r\n\r\n\r\n// Tasks\r\nconst createTask = async() => {\r\n\r\n    createTaskBtnRef.value.disabled = true;\r\n    createTaskBtnRef.value.innerText = 'Loading...'\r\n    const data = {content: inputTask.value};\r\n    \r\n    const response = await axios\r\n    .post('http://localhost:3000/tasks', data, {\r\n        headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json;charset=UTF-8\",\r\n        },\r\n        withCredentials: true,\r\n    })\r\n    inputTask.value = '';\r\n    tasks.value.push(response.data);\r\n    const responseDataId = response.data.id; \r\n    comments.value[responseDataId] = [];\r\n    likes.value[responseDataId] = '';\r\n    isEdit.value[responseDataId] = false;\r\n\r\n    console.log(comments.value);\r\n    console.log(likes.value);\r\n    // getTasks();\r\n    createTaskBtnRef.value.disabled = false;\r\n    createTaskBtnRef.value.innerText = 'Create Task';\r\n}\r\n\r\nconst getTasks = async() => {\r\n    const response = await axios.get('http://localhost:3000/tasks', {withCredentials: true});\r\n    tasks.value = response.data;\r\n    // state.tasks = response.data;\r\n}\r\n\r\nconst deleteTask = async (taskId) => {\r\n    await axios.delete(`http://localhost:3000/tasks/${taskId}`, {withCredentials: true});\r\n    tasks.value = tasks.value.filter(item => item.id !== taskId);\r\n    console.log(tasks.value);\r\n}\r\n\r\nconst editTask = async(taskId) => {\r\n    isEditting.value = true;\r\n    const editInputElement = document.getElementById(`editInput${taskId}`);\r\n    const data = {content: editInputElement.value}\r\n    await axios.patch(`http://localhost:3000/tasks/${taskId}`, data ,{withCredentials: true});\r\n    const task = tasks.value.find(element => element.id === taskId);\r\n    task.content = editInputElement.value;\r\n    isEditting.value = false;\r\n    isEdit.value[taskId] = false;\r\n    editInputElement.value = '';\r\n}\r\n\r\n\r\n// Comments\r\nconst addComment = async(taskId) => {\r\n\r\n    const inputCommentElement  = document.getElementById(`inputComment${taskId}`);\r\n    const buttonCommentElement = document.getElementById(`buttonComment${taskId}`);\r\n    console.log(inputCommentElement.value);\r\n    buttonCommentElement.disabled = true;\r\n    buttonCommentElement.classList.toggle('hover:bg-slate-100');\r\n    buttonCommentElement.innerText = 'Loading...';\r\n\r\n    const data = {content: inputCommentElement.value};\r\n    \r\n    const response = await axios\r\n    .post(`http://localhost:3000/tasks/${taskId}/comments`, data, {\r\n        headers: {\r\n        Accept: \"application/json\",\r\n        \"Content-Type\": \"application/json;charset=UTF-8\",\r\n        },\r\n        withCredentials: true,\r\n    })\r\n\r\n    inputCommentElement.value = '';\r\n    buttonCommentElement.disabled = false;\r\n    buttonCommentElement.innerText = 'Add comment';\r\n    buttonCommentElement.classList.toggle('hover:bg-slate-100');\r\n    comments.value[taskId].push(response.data)\r\n}\r\n\r\nconst deleteComment = async(commentId, taskId) => {\r\n    comments.value[taskId] = comments.value[taskId].filter(item => item.id !== commentId);\r\n    await axios.delete(`http://localhost:3000/tasks/comments/${commentId}`, {withCredentials: true});\r\n    // arr = arr.filter(item => item !== value)\r\n    console.log(comments.value[taskId]);\r\n\r\n}\r\n\r\nconst getCmtsFromOneTask = async(taskId) => {\r\n    const response = await axios.get(\r\n        `http://localhost:3000/tasks/${taskId}/comments`, \r\n        {withCredentials: true}\r\n    );\r\n    commentsOfOneTask.value = response.data;\r\n}\r\n\r\n\r\n// Likes\r\nconst likeClick = async(taskId) => {\r\n\r\n    if(likes.value[taskId].status === false || likes.value[taskId]  === '') {\r\n        if(likes.value[taskId]  === '') {\r\n           likes.value[taskId] = {};\r\n        }\r\n\r\n        likes.value[taskId].status  = true;\r\n        countLikes.value[taskId] += 1;\r\n        const data = {status: true};\r\n        await axios.post(`http://localhost:3000/tasks/${taskId}/likes`, data, {\r\n            headers: {\r\n                Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json;charset=UTF-8\",\r\n            },\r\n            withCredentials: true,\r\n        });\r\n    }\r\n    else if (likes.value[taskId].status  === true) {\r\n        // const data = {status: false};\r\n        // const index = likes.value.indexOf(taskId);\r\n        // likes.value[taskId].status = false;\r\n        // likes.value.splice(index, 1);\r\n        likes.value[taskId] = '';\r\n        countLikes.value[taskId] -= 1;\r\n        await axios.delete(`http://localhost:3000/tasks/${taskId}/likes`, {\r\n            headers: {\r\n            Accept: \"application/json\",\r\n            \"Content-Type\": \"application/json;charset=UTF-8\",\r\n            },\r\n            withCredentials: true,\r\n        });\r\n    }\r\n}\r\n\r\nonMounted( async() => {\r\n    const response = await axios.get('http://localhost:3000/tasks', {withCredentials: true});\r\n    console.log(response.data);\r\n    tasks.value = response.data;\r\n\r\n    let count = 0;\r\n    tasks.value.forEach(async(ele) => {\r\n        // const commentsLink = `http://localhost:3000/tasks/${ele.id}/comments`;\r\n        // const likesLink = `http://localhost:3000/tasks/${ele.id}/likes`;\r\n\r\n        // const requestComments = axios.get(commentsLink, {withCredentials: true});\r\n        // const requestLikes = axios.get(likesLink, {withCredentials: true});\r\n\r\n        // await axios.all([requestComments, requestLikes]).then(\r\n        //     axios.spread((...responses) => {\r\n        //     comments.value[ele.id] = responses[0];\r\n        //     likes.value[ele.id] = responses[1];\r\n        //     })\r\n        // );\r\n\r\n        let response;\r\n        response = await axios.get(\r\n            `http://localhost:3000/tasks/${ele.id}/comments`, \r\n            {withCredentials: true}\r\n        );\r\n        comments.value[ele.id] = response.data;\r\n\r\n        response = await axios.get(\r\n            `http://localhost:3000/tasks/${ele.id}/likes`, \r\n            {withCredentials: true}\r\n        );\r\n        likes.value[ele.id] = response.data;\r\n        isEdit.value[ele.id] = false;\r\n\r\n        response = await axios.get(\r\n            `http://localhost:3000/tasks/${ele.id}/countLikesOfTask`, \r\n            {withCredentials: true}\r\n        );\r\n        countLikes.value[ele.id] = response.data;\r\n    })\r\n\r\n    console.log(tasks.value);\r\n    console.log(comments.value);\r\n    console.log(likes.value);\r\n    console.log(isEdit.value);\r\n    console.log(countLikes.value);\r\n    \r\n})\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.liked {\r\n    color: dodgerblue;\r\n}\r\n\r\n.unliked {\r\n    color: darkgray;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}